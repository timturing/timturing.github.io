转载于：https://zhuanlan.zhihu.com/p/64664346

<div class="RichText ztext Post-RichText css-117anjg" options="[object Object]"><h2 data-first-child=""><b>引言</b></h2><p data-pid="n_c3u1OZ">本期由来自哈工大的同样热爱科普的潮汐之子为我们带来t-SNE的全方位普及，作者的研究方向为自然语言处理。<br></p><h2><b>说明</b></h2><p data-pid="XngZM7-x">本文目的是做成一个60分钟t-SNE闪电入门简介，可能无法详细讲解原理，学术帝还请阅读原论文，或请移步我的另一篇博文，里面多了一些论文笔记，相关链接：<br></p><p data-pid="rSZ1ShKi"><a href="https://link.zhihu.com/?target=https%3A//psubnwell.github.io/2017/12/01/paper-note-t-sne/" class=" external" target="_blank" rel="nofollow noreferrer" data-za-detail-view-id="1043"><span class="invisible">https://</span><span class="visible">psubnwell.github.io/201</span><span class="invisible">7/12/01/paper-note-t-sne/</span><span class="ellipsis"></span></a></p><p class="ztext-empty-paragraph"><br></p><h2><b>基础篇</b></h2><p data-pid="9VF32PLc"><b>认识高维空间：维数灾难</b></p><p data-pid="oWZ-gMNY">维数灾难（curse of dimensionality）：描述的是高维空间中若干迥异于低维空间、甚至反直觉的现象。该现象的详细论述可以阅读参考文献[1] ，其中通过超立方体和其内切球的推导十分精彩，这里不再赘述。</p><p data-pid="8SGfEcO7">★高维空间中数据样本极其稀疏。需要维度几何级数的数据才能满足在高维空间密采样（dense sample）。反过来，高维数据降维到低维空间也将发生“拥挤问题（Crowding Problem）[2]”</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-d18d66a90783fa8192a6db13252fc85c_b.png" data-caption="" data-size="normal" data-rawwidth="674" data-rawheight="245" class="origin_image zh-lightbox-thumb" width="674" data-original="https://pic1.zhimg.com/v2-d18d66a90783fa8192a6db13252fc85c_r.jpg"/></noscript><div><img src="https://pic1.zhimg.com/80/v2-d18d66a90783fa8192a6db13252fc85c_720w.webp" data-caption="" data-size="normal" data-rawwidth="674" data-rawheight="245" class="origin_image zh-lightbox-thumb lazy" width="674" data-original="https://pic1.zhimg.com/v2-d18d66a90783fa8192a6db13252fc85c_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-d18d66a90783fa8192a6db13252fc85c_b.png" data-original-token="v2-d18d66a90783fa8192a6db13252fc85c" height="245" data-lazy-status="ok"></div></figure><p data-pid="BBFIngWh">★高维单位空间中数据几乎全部位于超立方体的边缘。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-77c6f570cd46a9876c823f5077e16960_b.png" data-caption="" data-size="normal" data-rawwidth="674" data-rawheight="249" class="origin_image zh-lightbox-thumb" width="674" data-original="https://pic1.zhimg.com/v2-77c6f570cd46a9876c823f5077e16960_r.jpg"/></noscript><div><img src="https://pic1.zhimg.com/80/v2-77c6f570cd46a9876c823f5077e16960_720w.webp" data-caption="" data-size="normal" data-rawwidth="674" data-rawheight="249" class="origin_image zh-lightbox-thumb lazy" width="674" data-original="https://pic1.zhimg.com/v2-77c6f570cd46a9876c823f5077e16960_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-77c6f570cd46a9876c823f5077e16960_b.png" data-original-token="v2-77c6f570cd46a9876c823f5077e16960" height="249" data-lazy-status="ok"></div></figure><p data-pid="lBW4D9OS">几何学能给出高维空间中超几何体的体积，单位超立方体的体积为：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-2810c9c55baaf1d5e5f35c90279a5dcc_b.png" data-caption="" data-size="normal" data-rawwidth="574" data-rawheight="86" class="origin_image zh-lightbox-thumb" width="574" data-original="https://pic1.zhimg.com/v2-2810c9c55baaf1d5e5f35c90279a5dcc_r.jpg"/></noscript><div><img src="https://pic1.zhimg.com/80/v2-2810c9c55baaf1d5e5f35c90279a5dcc_720w.webp" data-caption="" data-size="normal" data-rawwidth="574" data-rawheight="86" class="origin_image zh-lightbox-thumb lazy" width="574" data-original="https://pic1.zhimg.com/v2-2810c9c55baaf1d5e5f35c90279a5dcc_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-2810c9c55baaf1d5e5f35c90279a5dcc_b.png" data-original-token="v2-2810c9c55baaf1d5e5f35c90279a5dcc" height="86" data-lazy-status="ok"></div></figure><p data-pid="-N5-iy4m">而其内切超球体的体积公式如下：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-8dff410ec7333a4d3c3b8f669d955c0f_b.jpg" data-caption="" data-size="normal" data-rawwidth="856" data-rawheight="240" class="origin_image zh-lightbox-thumb" width="856" data-original="https://pic4.zhimg.com/v2-8dff410ec7333a4d3c3b8f669d955c0f_r.jpg"/></noscript><div><img src="https://pic4.zhimg.com/80/v2-8dff410ec7333a4d3c3b8f669d955c0f_720w.webp" data-caption="" data-size="normal" data-rawwidth="856" data-rawheight="240" class="origin_image zh-lightbox-thumb lazy" width="856" data-original="https://pic4.zhimg.com/v2-8dff410ec7333a4d3c3b8f669d955c0f_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-8dff410ec7333a4d3c3b8f669d955c0f_b.jpg" data-original-token="v2-8dff410ec7333a4d3c3b8f669d955c0f" height="240" data-lazy-status="ok"></div></figure><p data-pid="KspZ1dJm"> 对两者商做极限可得：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-94f2f45084705824f3dfd555f8cdd457_b.jpg" data-caption="" data-size="normal" data-rawwidth="686" data-rawheight="133" class="origin_image zh-lightbox-thumb" width="686" data-original="https://pic4.zhimg.com/v2-94f2f45084705824f3dfd555f8cdd457_r.jpg"/></noscript><div><img src="https://pic4.zhimg.com/80/v2-94f2f45084705824f3dfd555f8cdd457_720w.webp" data-caption="" data-size="normal" data-rawwidth="686" data-rawheight="133" class="origin_image zh-lightbox-thumb lazy" width="686" data-original="https://pic4.zhimg.com/v2-94f2f45084705824f3dfd555f8cdd457_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-94f2f45084705824f3dfd555f8cdd457_b.jpg" data-original-token="v2-94f2f45084705824f3dfd555f8cdd457" height="133" data-lazy-status="ok"></div></figure><p data-pid="m_IsHabK">因此可以说一个高维单元空间只有边角，而没有中心。数据也只能处于边缘上，而远离中心。这样就直接导致了下一个性质：</p><p data-pid="HprGfuuT">★欧氏距离失效（因此任何基于欧氏距离的算法也失效）。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-6cf525a898a8e809c8caba3650a9ae0e_b.jpg" data-caption="" data-size="normal" data-rawwidth="366" data-rawheight="302" class="content_image" width="366"/></noscript><div><img src="https://pic3.zhimg.com/80/v2-6cf525a898a8e809c8caba3650a9ae0e_720w.webp" data-caption="" data-size="normal" data-rawwidth="366" data-rawheight="302" class="content_image lazy" width="366" data-actualsrc="https://pic3.zhimg.com/v2-6cf525a898a8e809c8caba3650a9ae0e_b.jpg" data-original-token="v2-6cf525a898a8e809c8caba3650a9ae0e" height="302" data-lazy-status="ok"></div></figure><p data-pid="JIcPLUPN">上图描述的是高维空间中大距离和小距离的差异越来越不明显：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-ceaa181d120bb62607becd18069f0559_b.jpg" data-caption="" data-size="normal" data-rawwidth="433" data-rawheight="90" class="origin_image zh-lightbox-thumb" width="433" data-original="https://pic2.zhimg.com/v2-ceaa181d120bb62607becd18069f0559_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='433' height='90'></svg>" data-caption="" data-size="normal" data-rawwidth="433" data-rawheight="90" class="origin_image zh-lightbox-thumb lazy" width="433" data-original="https://pic2.zhimg.com/v2-ceaa181d120bb62607becd18069f0559_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-ceaa181d120bb62607becd18069f0559_b.jpg" data-original-token="v2-ceaa181d120bb62607becd18069f0559"></div></figure><p data-pid="XXLAR6wr">这是由上一性质自然推导出的结论。</p><p class="ztext-empty-paragraph"><br></p><h2><b>降维</b></h2><p data-pid="jUXsS1k4">降维（dimension reduction）的基本作用：</p><p data-pid="Coj4CfFp">★缓解维数灾难。即提高样本密度，以及使基于欧氏距离的算法重新生效。</p><p data-pid="kdJn6RKU">★数据预处理。对数据去冗余、降低信噪比。</p><p data-pid="UUrNueHF">★方便可视化。</p><p data-pid="KXvL2eF9">降维的概念中有两对直觉性的概念会反复出现：高维/低维空间、高维/低维数据。在文献中他们有若干别称[3]：</p><p data-pid="YQjohPqq">★高维空间（high-dimensional space），又叫原空间（original space）</p><p data-pid="QbmZaqpT">★高维数据（low-dimensional data），也直接叫数据点（data points），用于和下述的映射点对应。</p><p data-pid="hD4XO5kD">★低维空间（low-dimensional space），又叫嵌入空间（embedded space）、低维映射（low-dimensional map，map在此做名词用）等。</p><p data-pid="bzib_dDW">★低维数据（low-dimensional data），又叫低维嵌入（low-dimensional embeddings）、低维表示（low-dimensional representations）、映射点（map points）等。</p><p data-pid="881CcvrX">嵌入（embedding）：数学上，嵌入是指一个数学结构经映射包含在另一个结构中。</p><p data-pid="-FRP86sK">★NLP目前所使用的词嵌入（word embedding）一词的本意可能就是这个意思。最初所使用的词向量是one-hot向量，维度等于词表大小（约几十万）。后来采用分布式表示的词向量，维度一般取几百维。因此我们认为分布式表示的词向量是更高维度语义空间的低维嵌入（embedding）。</p><p data-pid="YiKwIXCM">★"Embed Everything！" 嵌入的思想不仅可以用在词（word）上，还能用于许多其他技术上。如知识图谱中可以把原先的网络结构也做嵌入，有实体嵌入、关系嵌入等。</p><p data-pid="zk23qc4u">降维技术可以分为线性和非线性两大类：</p><p data-pid="imBuzt-D">★线性降维技术。侧重让不相似的点在低维表示中分开。</p><p data-pid="Kd0PmF8_">①PCA（Principle Components Analysis，主成分分析）</p><p data-pid="OtIV-u-3">②MDS（Multiple Dimensional Scaling，多维缩放）等</p><p data-pid="Pqhd8DHj">★非线性降维技术（广义上“非线性降维技术”≈“流形学习”，狭义上后者是前者子集）。这类技术假设高维数据实际上处于一个比所处空间维度低的非线性流形上，因此侧重让相似的近邻点在低维表示中靠近。</p><p data-pid="VMqg9vZx">①Sammon mapping</p><p data-pid="0iMPolZX">②SNE（Stochastic Neighbor Embedding，随机近邻嵌入），t-SNE是基于SNE的。</p><p data-pid="NimAYSd3">③Isomap（Isometric Mapping，等度量映射）</p><p data-pid="90o1-22L">④MVU（Maximum Variance Unfolding）</p><p data-pid="853zpH14">⑤LLE（Locally Linear Embedding，局部线性嵌入）等</p><p class="ztext-empty-paragraph"><br></p><h2><b>流形学习</b></h2><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-f6494eac67983eb1ac32447132abf1da_b.jpg" data-caption="" data-size="normal" data-rawwidth="942" data-rawheight="485" class="origin_image zh-lightbox-thumb" width="942" data-original="https://pic3.zhimg.com/v2-f6494eac67983eb1ac32447132abf1da_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='942' height='485'></svg>" data-caption="" data-size="normal" data-rawwidth="942" data-rawheight="485" class="origin_image zh-lightbox-thumb lazy" width="942" data-original="https://pic3.zhimg.com/v2-f6494eac67983eb1ac32447132abf1da_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-f6494eac67983eb1ac32447132abf1da_b.jpg" data-original-token="v2-f6494eac67983eb1ac32447132abf1da"></div></figure><p data-pid="7CS0aTmu">流形（manifold）：</p><p data-pid="ceplWpE4">★机器学习中指的流形指本征维度较低但嵌入在高维空间中的空间（a manifold haslow intrinsic dimensions, and is embedded within a space of much higher dimensionality[4] ）。比如上图中的S-curve数据集，本征维度=2（摊开来是一个二维空间），但被嵌在三维空间中。</p><p data-pid="zEkwS3Kw">★数学中提到流形，强调其具有局部欧式空间的性质，可以在局部应用欧几里得距离。但是在机器学习（流形学习）中，这个假设基本不成立。原因是高维空间由于维数灾难的存在，没有足够稠密的数据能在足够小的局部去近似该流形[5] 。</p><p data-pid="E8WEwDb_">★但是流形概念中局部的思想仍可以借鉴。它为降维提供了另一个视角：从微观角度去探索高维数据结构。</p><p data-pid="JWe5rtkA">距离[6] ：想象你是一只蚂蚁，在图中的二维曲面流形上行走。</p><p data-pid="BljTq-sx">★高维直线距离：左图黑线。这个距离没有意义！</p><p data-pid="SQM91tH3">★测地线距离：左图红线，右图红虚线。这个距离才有意义！</p><p data-pid="iCMkd3y3">★近邻距离：右图黑折线。用近邻距离可以拟合测地线距离。</p><p data-pid="SSBzUoha">学习：流形学习之所以叫学习，因为它不像PCA一类的纯线性代数降维方法，而是更像一个类似神经网络的学习算法。</p><p data-pid="8Tncv0tC">★神经网络大部分是有监督学习；流形学习大部分是无监督学习。</p><p data-pid="QAiN5uZG">★神经网络拟合一个分类函数；流形学习（以t-SNE为例）拟合高维数据的分布。</p><p data-pid="KFgyUZsL">★神经网络学习参数；流形学习（以t-SNE为例）直接学习低维数据的表达。</p><p data-pid="BoJPoxJF">★两者均有损失函数、梯度下降、迭代轮数等学习算法的特点。</p><p class="ztext-empty-paragraph"><br></p><h2><b>学术篇</b></h2><p data-pid="JhWIXW41"><b>SNE</b></p><p data-pid="bY9Ia_NN">SNE（Stochastic Neighbor Embedding，随机近邻嵌入）[7] </p><p data-pid="UKtaLODo">SNE两个主要思路/步骤：</p><p data-pid="KkuN0q_B">★将欧氏距离转化为条件概率来表征点间相似度（pairwise similarity）。</p><p data-pid="ppaRkeri">★使用梯度下降算法来使低维分布学习/拟合高维分布。</p><p data-pid="0_dteHH0">给定高维空间的数据点：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-bdb7912214d31fce2c6af41c23012743_b.png" data-caption="" data-size="small" data-rawwidth="279" data-rawheight="35" class="content_image" width="279"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='279' height='35'></svg>" data-caption="" data-size="small" data-rawwidth="279" data-rawheight="35" class="content_image lazy" width="279" data-actualsrc="https://pic4.zhimg.com/v2-bdb7912214d31fce2c6af41c23012743_b.png" data-original-token="v2-bdb7912214d31fce2c6af41c23012743"></div></figure><p data-pid="4G2NIOoD">是以x_i自己为中心，以高斯分布选择x_j作为近邻点的条件概率：<br></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-6c7839adf77837f820a56c65866c4fb0_b.png" data-caption="" data-size="normal" data-rawwidth="546" data-rawheight="96" class="origin_image zh-lightbox-thumb" width="546" data-original="https://pic1.zhimg.com/v2-6c7839adf77837f820a56c65866c4fb0_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='546' height='96'></svg>" data-caption="" data-size="normal" data-rawwidth="546" data-rawheight="96" class="origin_image zh-lightbox-thumb lazy" width="546" data-original="https://pic1.zhimg.com/v2-6c7839adf77837f820a56c65866c4fb0_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-6c7839adf77837f820a56c65866c4fb0_b.png" data-original-token="v2-6c7839adf77837f820a56c65866c4fb0"></div></figure><p data-pid="_q9yv3BT">注意：</p><p data-pid="h0yN4VbC">1）对除i外其他所有j都计算一个条件概率后，形成一个概率分布列，所以分母需要归一化；</p><p data-pid="Eyf-LYwV">2）默认p_(i|i)=0；</p><p data-pid="w4vCcuJT">3）每不同数据点x_i有不同的σ_i，在此不展开。</p><p data-pid="8eSkSfrW">同理，有低维空间的映射点：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-05466f918f0eb6499b966f73d3dc5439_b.png" data-caption="" data-size="small" data-rawwidth="198" data-rawheight="35" class="content_image" width="198"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='198' height='35'></svg>" data-caption="" data-size="small" data-rawwidth="198" data-rawheight="35" class="content_image lazy" width="198" data-actualsrc="https://pic2.zhimg.com/v2-05466f918f0eb6499b966f73d3dc5439_b.png" data-original-token="v2-05466f918f0eb6499b966f73d3dc5439"></div></figure><p data-pid="zGj-nwnB">分别对应：<br></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-074679e83fc00e00765c363047d928cd_b.jpg" data-caption="" data-size="small" data-rawwidth="208" data-rawheight="35" class="content_image" width="208"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='208' height='35'></svg>" data-caption="" data-size="small" data-rawwidth="208" data-rawheight="35" class="content_image lazy" width="208" data-actualsrc="https://pic2.zhimg.com/v2-074679e83fc00e00765c363047d928cd_b.jpg" data-original-token="v2-074679e83fc00e00765c363047d928cd"></div></figure><p data-pid="FQ00tSoD">q_(j|i)是y_i以自己为中心，以高斯分布选择y_j作为近邻点的条件概率：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-199662e473e2b331cb029ac467f3ba12_b.jpg" data-caption="" data-size="normal" data-rawwidth="523" data-rawheight="104" class="origin_image zh-lightbox-thumb" width="523" data-original="https://pic3.zhimg.com/v2-199662e473e2b331cb029ac467f3ba12_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='523' height='104'></svg>" data-caption="" data-size="normal" data-rawwidth="523" data-rawheight="104" class="origin_image zh-lightbox-thumb lazy" width="523" data-original="https://pic3.zhimg.com/v2-199662e473e2b331cb029ac467f3ba12_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-199662e473e2b331cb029ac467f3ba12_b.jpg" data-original-token="v2-199662e473e2b331cb029ac467f3ba12"></div></figure><p data-pid="znPz0p7W">注意：这里方差统一取σ_i=1/√2，若方差取其他值，对结果影响仅仅是缩放而已。</p><p data-pid="lqzmRkxw">SNE的目标是让低维分布去拟合高维分布，则目标是令两个分布一致。两个分布的一致程度可以使用相对熵（Mutual entropy，也叫做KL散度，Kullback-Leibler divergences，KLD）来衡量，可以以此定义代价函数（cost function）：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-8118a8ff57d2d208b2d535f2f349af83_b.jpg" data-caption="" data-size="normal" data-rawwidth="450" data-rawheight="75" class="origin_image zh-lightbox-thumb" width="450" data-original="https://pic4.zhimg.com/v2-8118a8ff57d2d208b2d535f2f349af83_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='450' height='75'></svg>" data-caption="" data-size="normal" data-rawwidth="450" data-rawheight="75" class="origin_image zh-lightbox-thumb lazy" width="450" data-original="https://pic4.zhimg.com/v2-8118a8ff57d2d208b2d535f2f349af83_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-8118a8ff57d2d208b2d535f2f349af83_b.jpg" data-original-token="v2-8118a8ff57d2d208b2d535f2f349af83"></div></figure><p data-pid="WNdvz8Mc">其中P_i (k=j)=p_(j|i) 和Q_i (k=j)=q_(j|i)是两个分布列。</p><p data-pid="hvpbCqt3">注意：KLD是不对称的！因为 KLD=plog(p/q)，p&gt;q时为正，p&lt;q时为负。则如果高维数据相邻而低维数据分开（即p大q小），则cost很大；相反，如果高维数据分开而低维数据相邻（即p小q大），则cost很小。所以SNE倾向于保留高维数据的局部结构。</p><p data-pid="m9hEkrWX">对C进行梯度下降即可以学习到合适的y_i。</p><p data-pid="XHx7OklM">梯度公式：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-71d95ac59f6a5fe49cede586c1d6cb03_b.jpg" data-caption="" data-size="normal" data-rawwidth="644" data-rawheight="106" class="origin_image zh-lightbox-thumb" width="644" data-original="https://pic4.zhimg.com/v2-71d95ac59f6a5fe49cede586c1d6cb03_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='644' height='106'></svg>" data-caption="" data-size="normal" data-rawwidth="644" data-rawheight="106" class="origin_image zh-lightbox-thumb lazy" width="644" data-original="https://pic4.zhimg.com/v2-71d95ac59f6a5fe49cede586c1d6cb03_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-71d95ac59f6a5fe49cede586c1d6cb03_b.jpg" data-original-token="v2-71d95ac59f6a5fe49cede586c1d6cb03"></div></figure><p data-pid="3lANev13">带动量的梯度更新公式：（这里给出单个y_i点的梯度下降公式，显然需要对所有：Y^(T)={y_1,y_2,...,y_n}进行统一迭代。）</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-9d7e0adba241c82637ba0a37bfbc9cea_b.jpg" data-caption="" data-size="normal" data-rawwidth="638" data-rawheight="87" class="origin_image zh-lightbox-thumb" width="638" data-original="https://pic3.zhimg.com/v2-9d7e0adba241c82637ba0a37bfbc9cea_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='638' height='87'></svg>" data-caption="" data-size="normal" data-rawwidth="638" data-rawheight="87" class="origin_image zh-lightbox-thumb lazy" width="638" data-original="https://pic3.zhimg.com/v2-9d7e0adba241c82637ba0a37bfbc9cea_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-9d7e0adba241c82637ba0a37bfbc9cea_b.jpg" data-original-token="v2-9d7e0adba241c82637ba0a37bfbc9cea"></div></figure><p class="ztext-empty-paragraph"><br></p><h2><b>t-SNE</b></h2><p data-pid="Umea0FqD">t-Distributed Stochastic Neighbor Embedding[8] </p><p data-pid="NSmwGYc6">事实上SNE并没有解决维度灾难带来的若干问题：</p><p data-pid="qhOBVVDh">★拥挤问题（Crowding Problem）：在二维映射空间中，能容纳（高维空间中的）中等距离间隔点的空间，不会比能容纳（高维空间中的）相近点的空间大太多[9]。 </p><p data-pid="lXRmM8Xg">★换言之，哪怕高维空间中离得较远的点，在低维空间中留不出这么多空间来映射。于是到最后高维空间中的点，尤其是远距离和中等距离的点，在低维空间中统统被塞在了一起，这就叫做“拥挤问题（Crowding Problem）”。</p><p data-pid="eniLjd7L">★拥挤问题带来的一个直接后果，就是高维空间中分离的簇，在低维中被分的不明显（但是可以分成一个个区块）。比如用SNE去可视化MNIST数据集的结果如下：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-ee2ec29037adaf25ad40c2c79f33aa36_b.jpg" data-caption="" data-size="normal" data-rawwidth="593" data-rawheight="594" class="origin_image zh-lightbox-thumb" width="593" data-original="https://pic3.zhimg.com/v2-ee2ec29037adaf25ad40c2c79f33aa36_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='593' height='594'></svg>" data-caption="" data-size="normal" data-rawwidth="593" data-rawheight="594" class="origin_image zh-lightbox-thumb lazy" width="593" data-original="https://pic3.zhimg.com/v2-ee2ec29037adaf25ad40c2c79f33aa36_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-ee2ec29037adaf25ad40c2c79f33aa36_b.jpg" data-original-token="v2-ee2ec29037adaf25ad40c2c79f33aa36"></div></figure><p data-pid="uxoNU0o9">如何解决？高维空间保持高斯分布不变，将低维空间的分布做调整，使得两边尾巴比高维空间的高斯分布更高，即可缓解拥挤问题。想一想为什么？（在下面t-分布中解释）</p><p data-pid="5M5pdmdk">★UNI-SNE[10]：给低维空间的点给予一个均匀分布（uniform dist），使得对于高维空间中距离较远的点（p_ij较小），强制保证在低维空间中q_ij&gt;p_ij （因为均匀分布的两边比高斯分布的两边高出太多了）。</p><p data-pid="9RlMHHLw">t-分布（Student's t-distribution）</p><p data-pid="oMy1RvKM">★t-分布的概率密度函数（probability density function，PDF）形式为：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-148800eb4834a8a2f53d5161dc09d2f5_b.jpg" data-caption="" data-size="normal" data-rawwidth="404" data-rawheight="124" class="content_image" width="404"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='404' height='124'></svg>" data-caption="" data-size="normal" data-rawwidth="404" data-rawheight="124" class="content_image lazy" width="404" data-actualsrc="https://pic2.zhimg.com/v2-148800eb4834a8a2f53d5161dc09d2f5_b.jpg" data-original-token="v2-148800eb4834a8a2f53d5161dc09d2f5"></div></figure><p data-pid="kYE_QPQC">其中 ν 是自由度。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-96d8c7df36c64c6e31fb26ce302beaaa_b.jpg" data-caption="" data-size="small" data-rawwidth="325" data-rawheight="260" class="content_image" width="325"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='325' height='260'></svg>" data-caption="" data-size="small" data-rawwidth="325" data-rawheight="260" class="content_image lazy" width="325" data-actualsrc="https://pic3.zhimg.com/v2-96d8c7df36c64c6e31fb26ce302beaaa_b.jpg" data-original-token="v2-96d8c7df36c64c6e31fb26ce302beaaa"></div></figure><p data-pid="Xv2GrXr3">figure of probability density function</p><p data-pid="ovlHqIRE">★当 ν=1:</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-9ea67f0ad73af9237d8a507c63af18ec_b.jpg" data-caption="" data-size="small" data-rawwidth="237" data-rawheight="79" class="content_image" width="237"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='237' height='79'></svg>" data-caption="" data-size="small" data-rawwidth="237" data-rawheight="79" class="content_image lazy" width="237" data-actualsrc="https://pic1.zhimg.com/v2-9ea67f0ad73af9237d8a507c63af18ec_b.jpg" data-original-token="v2-9ea67f0ad73af9237d8a507c63af18ec"></div></figure><p data-pid="fEkl3Ogu">叫做柯西分布（Cauchy distribution），我们用到是这个简单形式。</p><p data-pid="xeaOy7Rb">★当 ν=∞:</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-29420e5b7dd4d38c3d7e74a73c8452f2_b.jpg" data-caption="" data-size="small" data-rawwidth="226" data-rawheight="79" class="content_image" width="226"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='226' height='79'></svg>" data-caption="" data-size="small" data-rawwidth="226" data-rawheight="79" class="content_image lazy" width="226" data-actualsrc="https://pic3.zhimg.com/v2-29420e5b7dd4d38c3d7e74a73c8452f2_b.jpg" data-original-token="v2-29420e5b7dd4d38c3d7e74a73c8452f2"></div></figure><p data-pid="CBXHOeHS">叫做高斯/正态分布（Guassian/Normal distribution）。</p><p data-pid="XIVE3HnN">我们在低维空间的分布中，把原先用的高斯分布改成自由度为1的分布（把尾巴抬高）。下图可以很好地说明为什么“把尾巴抬高”可以很好地缓解拥挤问题。绘图代码参考 [11]</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-58141d84deaf628d67ada6adb4d39ae8_b.jpg" data-caption="" data-size="normal" data-rawwidth="686" data-rawheight="454" class="origin_image zh-lightbox-thumb" width="686" data-original="https://pic1.zhimg.com/v2-58141d84deaf628d67ada6adb4d39ae8_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='686' height='454'></svg>" data-caption="" data-size="normal" data-rawwidth="686" data-rawheight="454" class="origin_image zh-lightbox-thumb lazy" width="686" data-original="https://pic1.zhimg.com/v2-58141d84deaf628d67ada6adb4d39ae8_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-58141d84deaf628d67ada6adb4d39ae8_b.jpg" data-original-token="v2-58141d84deaf628d67ada6adb4d39ae8"></div></figure><p data-pid="2ZRLAdKj">假设我们的低维数据分布对高维数据分布已经拟合完毕，则可以认为对于高维数据点x_i、x_j和低维映射点y_i、y_j，有p_ij=q_ij。我们用图中两条红线表示两种情况：</p><p data-pid="Zabd4zIz">①上面的红线表示：当两个点相距相对近的时候，低维空间中比高维空间中相对更近。</p><p data-pid="eV4gtIcr">②下面的红线表示：当两个点相距相对远的时候，低维空间中比高维空间中相对更远。</p><p data-pid="w8f1ffdI">可以对比一下采用t-SNE对MNIST数据集的降维可视化效果:</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-94a2c1ff56a08619f1423310ce213219_b.gif" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="640" data-thumbnail="https://pic2.zhimg.com/v2-94a2c1ff56a08619f1423310ce213219_b.jpg" class="origin_image zh-lightbox-thumb" width="640" data-original="https://pic2.zhimg.com/v2-94a2c1ff56a08619f1423310ce213219_r.jpg"/></noscript><div><div class="GifPlayer css-1isopsn" data-size="normal" data-za-detail-view-path-module="GifItem"><img class="ztext-gif" width="640" role="presentation" src="https://pic2.zhimg.com/v2-94a2c1ff56a08619f1423310ce213219_b.jpg" data-thumbnail="https://pic2.zhimg.com/v2-94a2c1ff56a08619f1423310ce213219_b.jpg" data-size="normal" alt="动图封面" style="display: block;"><div class="GifPlayer-icon css-d39tw7"><svg width="50" height="50" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><ellipse fill="#000" opacity="0.45" cx="30" cy="30" rx="30" ry="30"></ellipse><ellipse stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" opacity="0.5" cx="30" cy="30" rx="26" ry="26"></ellipse></g><svg x="16" y="18.5"><g fill="#fff"><path x="100" y="100" d="M12.8422852,12.9814453 L12.8422852,11.3994141 L7.63916016,11.3994141 L7.63916016,13.0517578 L10.9086914,13.0517578 L10.9086914,13.3242188 C10.8911133,15.2050781 9.46728516,16.4707031 7.39306641,16.4707031 C5.01123047,16.4707031 3.51708984,14.625 3.51708984,11.6367188 C3.51708984,8.70117188 5.00244141,6.84667969 7.34912109,6.84667969 C9.08056641,6.84667969 10.284668,7.68164062 10.7768555,9.2109375 L12.7543945,9.2109375 C12.3237305,6.64453125 10.2319336,5.00976562 7.34912109,5.00976562 C3.79833984,5.00976562 1.50439453,7.61132812 1.50439453,11.6542969 C1.50439453,15.75 3.77197266,18.3076172 7.36669922,18.3076172 C10.6889648,18.3076172 12.8422852,16.2246094 12.8422852,12.9814453 Z M17.5180664,18 L17.5180664,5.31738281 L15.5493164,5.31738281 L15.5493164,18 L17.5180664,18 Z M22.659668,18 L22.659668,12.7441406 L28.1088867,12.7441406 L28.1088867,11.0039062 L22.659668,11.0039062 L22.659668,7.11035156 L28.6098633,7.11035156 L28.6098633,5.31738281 L20.690918,5.31738281 L20.690918,18 L22.659668,18 Z"></path></g></svg></svg></div></div></div></figure><p data-pid="HU0Ulkml">以上是t-SNE的主要思想，其余还有若干知识点（如对称SNE、优化的技巧等），请参考论文[12]或者我的另一篇博文：论文笔记：Visualizing data using t-SNE，相关链接：</p><p data-pid="hAUzLY_t"><a href="https://link.zhihu.com/?target=https%3A//psubnwell.github.io/2017/12/01/paper-note-t-sne/" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">psubnwell.github.io/201</span><span class="invisible">7/12/01/paper-note-t-sne/</span><span class="ellipsis"></span></a></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-d9282f6e6e2a134600e6fcc68ac0337d_b.gif" data-caption="" data-size="small" data-rawwidth="160" data-rawheight="160" data-thumbnail="https://pic2.zhimg.com/v2-d9282f6e6e2a134600e6fcc68ac0337d_b.jpg" class="content_image" width="160"/></noscript><div><div class="GifPlayer css-o0k2vi" data-size="small" data-za-detail-view-path-module="GifItem"><img class="ztext-gif" width="160" role="presentation" src="https://pic2.zhimg.com/v2-d9282f6e6e2a134600e6fcc68ac0337d_b.jpg" data-thumbnail="https://pic2.zhimg.com/v2-d9282f6e6e2a134600e6fcc68ac0337d_b.jpg" data-size="small" alt="动图封面" style="display: block;"><div class="GifPlayer-icon css-d39tw7"><svg width="50" height="50" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><ellipse fill="#000" opacity="0.45" cx="30" cy="30" rx="30" ry="30"></ellipse><ellipse stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" opacity="0.5" cx="30" cy="30" rx="26" ry="26"></ellipse></g><svg x="16" y="18.5"><g fill="#fff"><path x="100" y="100" d="M12.8422852,12.9814453 L12.8422852,11.3994141 L7.63916016,11.3994141 L7.63916016,13.0517578 L10.9086914,13.0517578 L10.9086914,13.3242188 C10.8911133,15.2050781 9.46728516,16.4707031 7.39306641,16.4707031 C5.01123047,16.4707031 3.51708984,14.625 3.51708984,11.6367188 C3.51708984,8.70117188 5.00244141,6.84667969 7.34912109,6.84667969 C9.08056641,6.84667969 10.284668,7.68164062 10.7768555,9.2109375 L12.7543945,9.2109375 C12.3237305,6.64453125 10.2319336,5.00976562 7.34912109,5.00976562 C3.79833984,5.00976562 1.50439453,7.61132812 1.50439453,11.6542969 C1.50439453,15.75 3.77197266,18.3076172 7.36669922,18.3076172 C10.6889648,18.3076172 12.8422852,16.2246094 12.8422852,12.9814453 Z M17.5180664,18 L17.5180664,5.31738281 L15.5493164,5.31738281 L15.5493164,18 L17.5180664,18 Z M22.659668,18 L22.659668,12.7441406 L28.1088867,12.7441406 L28.1088867,11.0039062 L22.659668,11.0039062 L22.659668,7.11035156 L28.6098633,7.11035156 L28.6098633,5.31738281 L20.690918,5.31738281 L20.690918,18 L22.659668,18 Z"></path></g></svg></svg></div></div></div></figure><p class="ztext-empty-paragraph"><br></p><p data-pid="bjfdJd8B"><b>工程篇</b></p><p><b></b></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-d9282f6e6e2a134600e6fcc68ac0337d_b.gif" data-caption="" data-size="small" data-rawwidth="160" data-rawheight="160" data-thumbnail="https://pic2.zhimg.com/v2-d9282f6e6e2a134600e6fcc68ac0337d_b.jpg" class="content_image" width="160"/></noscript><b><div><div class="GifPlayer css-o0k2vi" data-size="small" data-za-detail-view-path-module="GifItem"><img class="ztext-gif" width="160" role="presentation" src="https://pic2.zhimg.com/v2-d9282f6e6e2a134600e6fcc68ac0337d_b.jpg" data-thumbnail="https://pic2.zhimg.com/v2-d9282f6e6e2a134600e6fcc68ac0337d_b.jpg" data-size="small" alt="动图封面" style="display: block;"><div class="GifPlayer-icon css-d39tw7"><svg width="50" height="50" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><ellipse fill="#000" opacity="0.45" cx="30" cy="30" rx="30" ry="30"></ellipse><ellipse stroke="#FFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" opacity="0.5" cx="30" cy="30" rx="26" ry="26"></ellipse></g><svg x="16" y="18.5"><g fill="#fff"><path x="100" y="100" d="M12.8422852,12.9814453 L12.8422852,11.3994141 L7.63916016,11.3994141 L7.63916016,13.0517578 L10.9086914,13.0517578 L10.9086914,13.3242188 C10.8911133,15.2050781 9.46728516,16.4707031 7.39306641,16.4707031 C5.01123047,16.4707031 3.51708984,14.625 3.51708984,11.6367188 C3.51708984,8.70117188 5.00244141,6.84667969 7.34912109,6.84667969 C9.08056641,6.84667969 10.284668,7.68164062 10.7768555,9.2109375 L12.7543945,9.2109375 C12.3237305,6.64453125 10.2319336,5.00976562 7.34912109,5.00976562 C3.79833984,5.00976562 1.50439453,7.61132812 1.50439453,11.6542969 C1.50439453,15.75 3.77197266,18.3076172 7.36669922,18.3076172 C10.6889648,18.3076172 12.8422852,16.2246094 12.8422852,12.9814453 Z M17.5180664,18 L17.5180664,5.31738281 L15.5493164,5.31738281 L15.5493164,18 L17.5180664,18 Z M22.659668,18 L22.659668,12.7441406 L28.1088867,12.7441406 L28.1088867,11.0039062 L22.659668,11.0039062 L22.659668,7.11035156 L28.6098633,7.11035156 L28.6098633,5.31738281 L20.690918,5.31738281 L20.690918,18 L22.659668,18 Z"></path></g></svg></svg></div></div></div></b></figure><p></p><h2><b>Python库：sklearn.manifold</b></h2><p data-pid="iDjW9PR7">推荐阅读Python下著名的机器学习库scikit-learn的相应文档：sklearn.manifold.TSNE - scikit-learn，相关链接：</p><p data-pid="ZvptoRup"><a href="https://link.zhihu.com/?target=https%3A//scikit-learn.org/stable/modules/manifold.html%23t-distributed-stochastic-neighbor-embedding-t-sne" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">scikit-learn.org/stable</span><span class="invisible">/modules/manifold.html#t-distributed-stochastic-neighbor-embedding-t-sne</span><span class="ellipsis"></span></a></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-3653aaa4b3d4212ee0d0982afe0bb271_b.jpg" data-caption="" data-size="normal" data-rawwidth="802" data-rawheight="307" class="origin_image zh-lightbox-thumb" width="802" data-original="https://pic2.zhimg.com/v2-3653aaa4b3d4212ee0d0982afe0bb271_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='802' height='307'></svg>" data-caption="" data-size="normal" data-rawwidth="802" data-rawheight="307" class="origin_image zh-lightbox-thumb lazy" width="802" data-original="https://pic2.zhimg.com/v2-3653aaa4b3d4212ee0d0982afe0bb271_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-3653aaa4b3d4212ee0d0982afe0bb271_b.jpg" data-original-token="v2-3653aaa4b3d4212ee0d0982afe0bb271"></div></figure><p class="ztext-empty-paragraph"><br></p><p class="ztext-empty-paragraph"><br></p><h2><b>困惑度</b></h2><p data-pid="tLJuiMRi">使用t-SNE时，除了指定你想要降维的维度（参数n_components），另一个重要的参数是困惑度（Perplexity，参数perplexity）。</p><p data-pid="c6T1qAiD">困惑度大致表示如何在局部或者全局位面上平衡关注点，再说的具体一点就是关于对每个点周围邻居数量猜测。困惑度对最终成图有着复杂的影响。</p><p data-pid="YCzmTtji">前面提到高维空间中每一个数据点x_i的高斯分布中的方差σ_i都必须设为不同。该方差σ_i须具有如下性质：在数据密集的地方要小，数据稀疏的地方要大。显然σ_i和困惑度有着相关关系。</p><p data-pid="19e56qJm">如何给每个x_i分配σ_i值呢？</p><p data-pid="w6QDJzXO">★可以手动分配[13] </p><p data-pid="gocXBsHT">★使用算法分配：Binary search[14]或者 Root-finding method[15]</p><p data-pid="fyWDoXcS">使用算法来确定σ_i则要求用户预设困惑度。然后算法找到合适的σ_i值让条件分布P_i的困惑度等于用户预定义的困惑度即可。</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-3586bfb5fe1fab2ff739a613b56a72d6_b.jpg" data-caption="" data-size="normal" data-rawwidth="524" data-rawheight="43" class="origin_image zh-lightbox-thumb" width="524" data-original="https://pic3.zhimg.com/v2-3586bfb5fe1fab2ff739a613b56a72d6_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='524' height='43'></svg>" data-caption="" data-size="normal" data-rawwidth="524" data-rawheight="43" class="origin_image zh-lightbox-thumb lazy" width="524" data-original="https://pic3.zhimg.com/v2-3586bfb5fe1fab2ff739a613b56a72d6_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-3586bfb5fe1fab2ff739a613b56a72d6_b.jpg" data-original-token="v2-3586bfb5fe1fab2ff739a613b56a72d6"></div></figure><p data-pid="Gf0izycU">注意：困惑度设的大，则显然σ_i也大。两者是单调关系，因此可以使用二分查找。</p><p data-pid="ZiDpUMvm">论文[16]建议困惑度设为5-50比较好。这还是一个很大的范围，事实上在这个范围内，调节困惑度可以展示从微观到宏观的一系列视角，见下一节。</p><p class="ztext-empty-paragraph"><br></p><h2><b>可视化</b></h2><p data-pid="-bb__1AJ">日常使用t-SNE可调的参数基本只有困惑度，非常简单。针对困惑度如何影响可视化结果，文献[17]做了非常详细的展示，还包含一个在线程序可以辅助认识。<br></p><p data-pid="0OJri5pe">文献[18]给出的基本结论如下：</p><p data-pid="HKEY9XGz">★簇（cluster）的大小无关紧要。</p><p data-pid="LFq-0jJj">★簇之间的距离无关紧要。</p><p data-pid="fiA1vOtu">★密集的区域会被扩大，稀疏的区域会被缩小等。</p><p data-pid="ECdWlDJz">根据文献[19]给的图，说一点自己的理解：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-f09d37b19b2df145e4c48455e37bb254_b.jpg" data-caption="" data-size="normal" data-rawwidth="869" data-rawheight="345" class="origin_image zh-lightbox-thumb" width="869" data-original="https://pic1.zhimg.com/v2-f09d37b19b2df145e4c48455e37bb254_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='869' height='345'></svg>" data-caption="" data-size="normal" data-rawwidth="869" data-rawheight="345" class="origin_image zh-lightbox-thumb lazy" width="869" data-original="https://pic1.zhimg.com/v2-f09d37b19b2df145e4c48455e37bb254_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-f09d37b19b2df145e4c48455e37bb254_b.jpg" data-original-token="v2-f09d37b19b2df145e4c48455e37bb254"></div></figure><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-ae47be251864ca388c4bfa3dd4a7548d_b.png" data-caption="" data-size="normal" data-rawwidth="854" data-rawheight="345" class="origin_image zh-lightbox-thumb" width="854" data-original="https://pic2.zhimg.com/v2-ae47be251864ca388c4bfa3dd4a7548d_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='854' height='345'></svg>" data-caption="" data-size="normal" data-rawwidth="854" data-rawheight="345" class="origin_image zh-lightbox-thumb lazy" width="854" data-original="https://pic2.zhimg.com/v2-ae47be251864ca388c4bfa3dd4a7548d_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-ae47be251864ca388c4bfa3dd4a7548d_b.png" data-original-token="v2-ae47be251864ca388c4bfa3dd4a7548d"></div></figure><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-b2c95a2a967e9ff13236a989f6c69ca0_b.jpg" data-caption="" data-size="normal" data-rawwidth="875" data-rawheight="355" class="origin_image zh-lightbox-thumb" width="875" data-original="https://pic1.zhimg.com/v2-b2c95a2a967e9ff13236a989f6c69ca0_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='875' height='355'></svg>" data-caption="" data-size="normal" data-rawwidth="875" data-rawheight="355" class="origin_image zh-lightbox-thumb lazy" width="875" data-original="https://pic1.zhimg.com/v2-b2c95a2a967e9ff13236a989f6c69ca0_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-b2c95a2a967e9ff13236a989f6c69ca0_b.jpg" data-original-token="v2-b2c95a2a967e9ff13236a989f6c69ca0"></div></figure><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-2ad78a086b202a65a1e45dcda60a9c23_b.jpg" data-caption="" data-size="normal" data-rawwidth="861" data-rawheight="349" class="origin_image zh-lightbox-thumb" width="861" data-original="https://pic4.zhimg.com/v2-2ad78a086b202a65a1e45dcda60a9c23_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='861' height='349'></svg>" data-caption="" data-size="normal" data-rawwidth="861" data-rawheight="349" class="origin_image zh-lightbox-thumb lazy" width="861" data-original="https://pic4.zhimg.com/v2-2ad78a086b202a65a1e45dcda60a9c23_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-2ad78a086b202a65a1e45dcda60a9c23_b.jpg" data-original-token="v2-2ad78a086b202a65a1e45dcda60a9c23"></div></figure><p class="ztext-empty-paragraph"><br></p><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-69a96327fe9161818f54fd4a5ea3905e_b.jpg" data-caption="" data-size="normal" data-rawwidth="871" data-rawheight="344" class="origin_image zh-lightbox-thumb" width="871" data-original="https://pic3.zhimg.com/v2-69a96327fe9161818f54fd4a5ea3905e_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='871' height='344'></svg>" data-caption="" data-size="normal" data-rawwidth="871" data-rawheight="344" class="origin_image zh-lightbox-thumb lazy" width="871" data-original="https://pic3.zhimg.com/v2-69a96327fe9161818f54fd4a5ea3905e_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-69a96327fe9161818f54fd4a5ea3905e_b.jpg" data-original-token="v2-69a96327fe9161818f54fd4a5ea3905e"></div></figure><p class="ztext-empty-paragraph"><br></p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-a5c9907f4e9a866b02bcbe7403374061_b.jpg" data-caption="" data-size="normal" data-rawwidth="855" data-rawheight="347" class="origin_image zh-lightbox-thumb" width="855" data-original="https://pic2.zhimg.com/v2-a5c9907f4e9a866b02bcbe7403374061_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='855' height='347'></svg>" data-caption="" data-size="normal" data-rawwidth="855" data-rawheight="347" class="origin_image zh-lightbox-thumb lazy" width="855" data-original="https://pic2.zhimg.com/v2-a5c9907f4e9a866b02bcbe7403374061_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-a5c9907f4e9a866b02bcbe7403374061_b.jpg" data-original-token="v2-a5c9907f4e9a866b02bcbe7403374061"></div></figure><p data-pid="z1w5Rtj3">★低困惑度对应的是局部视角，要把自己想象成一只蚂蚁，在数据所在的流形上一个点一个点地探索。</p><p data-pid="Nv0xZ_EI">★高困惑度对应的是全局视角，要把自己想象成上帝。</p><p class="ztext-empty-paragraph"><br></p><h2><b>t-SNE优点</b></h2><p data-pid="9CE7Xzda">流形学习中其他方法如Isomap、LLE等，主要用于展开单个连续的低维流形（比如“瑞士卷”数据集），而t-SNE主要用于数据的局部结构，并且会倾向于提取出局部的簇，这种能力对于可视化同时包含多个流形的高维数据（比如MNIST数据集）很有效。<br></p><h2><b>t-SNE缺点</b></h2><p data-pid="cBXvPXSR">➊时间、空间复杂度为O(n^2)，计算代价昂贵。百万量级的数据需要几小时，对于PCA可能只需要几分钟。</p><p data-pid="Aomax9Jz">➋升级版Barnes-Hut t-SNE可以让复杂度降为O(nlogn)，但只限于获得二维和三维的嵌入。（sklearn中可以直接使用参数method='barnes_hut'）</p><p data-pid="ojpLyqJM">➌由于代价函数非凸，多次执行算法的结果是随机的（名字中“Stochatsic”的由来？），需要多次运行选取最好的结果。</p><p data-pid="42xjJqum">➍全局结构不能很清楚的保留。这个问题可以通过先用PCA降维到一个合理的维度（如50）后再用t-SNE来缓解，前置的PCA步骤也可以起到去除噪声等功能。（sklearn中可以直接使用参数init='pca'）</p><p class="ztext-empty-paragraph"><br></p><h2><b>尾声</b></h2><p data-pid="6r_-_ikF">作为一个三维生物，如何感知高维空间的形状，这个是历史难题。在读《三体》的时候，褐蚁的故事曾经让我若有所思，我将其摘录于此。它的方案和t-SNE是否有某种神似呢？</p><p data-pid="NI43SfFu">这次褐蚁来到故地，只是觅食途中偶然路过而已。它来到孤峰脚下，用触须摸了摸这顶天立地的存在，发现孤峰的表面坚硬光滑，但能爬上去，于是它向上爬去。没有什么且的，只是那小小的简陋神经网络中的一次随机扰动所致。这扰动随处可见，在地面的每一株小草和草叶上的每一粒露珠中，在天空中的每一片云和云后的每一颗星辰上……扰动都是无目的的，但巨量的无目的扰动汇集在一起，目的就出现了。...</p><p data-pid="NpPRZ7n6">与此同时，在前方的峭壁上，它遇到了一道长长的沟槽，与峭壁表面相比，沟槽的凹面粗糙一些，颜色也不同，呈灰白色，它沿着沟槽爬，粗糙的表面使攀登容易了许多。沟槽的两端都有短小的细槽。下端的细槽与主槽垂直，上端的细槽则与主槽成一个角度相交。当褐蚁重新踏上峭壁光滑的黑色表面后，它对槽的整体形状有了一个印象：“1”。...</p><p data-pid="r5ZR2R66">很快，它遇到了另一道沟槽，它很留恋沟槽那粗糙的凹面，在上面爬行感觉很好，同时槽面的颜色也让它想起了蚁后周围的蚁卵。它不惜向下走回头路，沿着槽爬了一趟。这道槽的形状要复杂些，很弯曲，转了一个完整的圈后再向下延伸一段，让它想起在对气味信息的搜寻后终于找到了回家的路的过程，它在自己的神经网络中建立起了它的形状：“9”。...</p><p data-pid="f5q87Yy7">褐蚁继续沿着与地面平行的方向爬，进入了第三道沟槽，它是一个近似于直角的转弯，是这样的：“7”。它不喜欢这形状，平时，这种不平滑的、突然的转向，往往意味着危险和战斗。...</p><p data-pid="Crt-zkfX">孤峰上的褐蚁本来想转向向上攀登，但发现前面还有一道凹槽，同在“7”之前爬过的那个它喜欢的形状“9”一模一样，它就再横行过去，爬了一遍这个“9”。它觉得这个形状比“7”和“1”好，好在哪里当然说不清，这是美感的原始单细胞态；刚才爬过“9”时的那种模糊的愉悦感再次加强了，这是幸福的原始单细胞态。但这两种精神的单细胞没有进化的机会，现在同一亿年前一样，同一亿年后也一样。</p><p class="ztext-empty-paragraph"><br></p><h2><b>参考文献</b></h2><div class="highlight"><pre><code class="language-text">[1] The Curse of Dimensionality in classification（链接：http://www.visiondummy.com/2014/04/curse-dimensionality-affect-classification/）, 中文翻译：维度灾难（链接：https://zhuanlan.zhihu.com/p/27488363）
[2] Maaten, L. V. D., &amp; Hinton, G. (2008). Visualizing data using t-SNE. Journal of Machine Learning Research, 9(Nov), 2579-2605.
[3] Maaten, L. V. D., &amp; Hinton, G. (2008). Visualizing data using t-SNE. Journal of Machine Learning Research, 9(Nov), 2579-2605.
[4] Maaten, L. V. D., &amp; Hinton, G. (2008). Visualizing data using t-SNE. Journal of Machine Learning Research, 9(Nov), 2579-2605.
[5] 有哪些关于流形学习（manifold learning）的好的资料或者课程？ - 知乎（链接：https://www.zhihu.com/question/41106133/answer/154709827）
[6] 周志华. 机器学习第十章[M]. Qing hua da xue chu ban she, 2016.
[7] Hinton, G. E., &amp; Roweis, S. T. (2003). Stochastic neighbor embedding. In Advances in neural information processing systems (pp. 857-864).
[8] Maaten, L. V. D., &amp; Hinton, G. (2008). Visualizing data using t-SNE. Journal of Machine Learning Research, 9(Nov), 2579-2605.
[9] Maaten, L. V. D., &amp; Hinton, G. (2008). Visualizing data using t-SNE. Journal of Machine Learning Research, 9(Nov), 2579-2605.
[10] Cook, J., Sutskever, I., Mnih, A., &amp; Hinton, G. (2007, March). Visualizing similarity data with a mixture of maps. In Artificial Intelligence and Statistics (pp. 67-74).
[11] t-SNE完整笔记。（链接：http://www.datakit.cn/blog/2017/02/05/t_sne_full.html）
[12] Maaten, L. V. D., &amp; Hinton, G. (2008). Visualizing data using t-SNE. Journal of Machine Learning Research, 9(Nov), 2579-2605.
[13] Hinton, G. E., &amp; Roweis, S. T. (2003). Stochastic neighbor embedding. In Advances in neural information processing systems (pp. 857-864).
[14] Hinton, G. E., &amp; Roweis, S. T. (2003). Stochastic neighbor embedding. In Advances in neural information processing systems (pp. 857-864).
[15] Van Der Maaten, L. (2014). Accelerating t-SNE using tree-based algorithms. Journal of machine learning research, 15(1), 3221-3245.
[16] Maaten, L. V. D., &amp; Hinton, G. (2008). Visualizing data using t-SNE. Journal of Machine Learning Research, 9(Nov), 2579-2605.
[17] Wattenberg, M., Viégas, F., &amp; Johnson, I. (2016). How to Use t-SNE Effectively. Distill, 1(10), e2.（链接：https://distill.pub/2016/misread-tsne/）
[18] Wattenberg, M., Viégas, F., &amp; Johnson, I. (2016). How to Use t-SNE Effectively. Distill, 1(10), e2.（链接：https://distill.pub/2016/misread-tsne/）
[19] Wattenberg, M., Viégas, F., &amp; Johnson, I. (2016). How to Use t-SNE Effectively. Distill, 1(10), e2.（链接：https://distill.pub/2016/misread-tsne/）</code></pre></div><p class="ztext-empty-paragraph"><br></p><p data-pid="Jc3plu5i">@纯真学者出神入化</p><p data-pid="XhsXQkw0">版权声明</p><p data-pid="Dcwp2N0Y">本文版权归《纯真学者出神入化》，转载请自行联系。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-6e60dce1ecec626a00ab6d2e39930e98_b.png" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="346" class="origin_image zh-lightbox-thumb" width="640" data-original="https://pic1.zhimg.com/v2-6e60dce1ecec626a00ab6d2e39930e98_r.jpg"/></noscript><div><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='640' height='346'></svg>" data-caption="" data-size="normal" data-rawwidth="640" data-rawheight="346" class="origin_image zh-lightbox-thumb lazy" width="640" data-original="https://pic1.zhimg.com/v2-6e60dce1ecec626a00ab6d2e39930e98_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-6e60dce1ecec626a00ab6d2e39930e98_b.png" data-original-token="v2-6e60dce1ecec626a00ab6d2e39930e98"></div></figure><p></p></div>